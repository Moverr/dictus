(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["settings_fields"],{"0514":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.collectionInfo?i("div",{staticClass:"settings-fields"},[i("v-header",{attrs:{breadcrumb:e.breadcrumb,"icon-link":"/"+e.currentProjectKey+"/settings/collections",settings:""}},[i("template",{slot:"buttons"},[i("v-header-button",{key:"delete",attrs:{icon:"delete_outline","background-color":"danger","icon-color":"white","hover-color":"danger-dark",label:e.$t("delete")},on:{click:function(t){e.confirmRemove=!0}}}),i("v-header-button",{key:"save",attrs:{icon:"check","background-color":"button-primary-background-color","icon-color":"button-primary-text-color",loading:e.saving,disabled:0===Object.keys(e.edits).length,label:e.$t("save")},on:{click:e.save}})],1)],2),i("label",{staticClass:"type-label"},[e._v(e._s(e.$tc("field",2)))]),i("v-notice",{attrs:{color:"warning",icon:"warning"}},[e._v(e._s(e.$t("fields_are_saved_instantly")))]),i("div",{staticClass:"table"},[i("div",{staticClass:"header"},[i("div",{staticClass:"row"},[i("div",{staticClass:"drag"},[i("v-icon",{attrs:{name:"swap_vert"}})],1),i("div",[e._v(e._s(e.$tc("field",1)))]),i("div",[e._v(e._s(e.$tc("interface",1)))])])]),i("div",{staticClass:"body",class:{dragging:e.dragging}},[i("draggable",{on:{start:e.startSort,end:e.saveSort},model:{value:e.fields,callback:function(t){e.fields=t},expression:"fields"}},e._l(e.fields,(function(t){return i("div",{key:t.field,staticClass:"row"},[i("div",{staticClass:"drag"},[i("v-icon",{attrs:{name:"drag_handle"}})],1),i("div",{staticClass:"inner row",style:{cursor:t.interface?"inherit":"default"},on:{click:function(i){i.stopPropagation(),t.interface&&e.startEditingField(t)}}},[i("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.field.length>25?t.field:null,expression:"field.field.length > 25 ? field.field : null"}],staticClass:"monospace"},[e._v(" "+e._s(t.field)+" ")]),i("div",[e._v(" "+e._s(e.$store.state.extensions.interfaces[t.interface]&&e.$store.state.extensions.interfaces[t.interface].name)+" "),t.interface?e._e():i("v-button",{staticClass:"not-managed",attrs:{loading:e.toManage.includes(t.field)},on:{click:function(i){return e.manageField(t)}}},[e._v(" "+e._s(e.$t("manage"))+" ")])],1)]),e.canDuplicate(t.interface)||e.fields.length>1?i("v-contextual-menu",{staticClass:"more-options",attrs:{placement:"left-start",options:e.fieldOptions(t)},on:{click:function(i){return e.fieldOptionsClicked(t,i)}}}):e._e()],1)})),0)],1)]),i("v-button",{staticClass:"new-field",on:{click:function(t){return e.startEditingField({})}}},[e._v(" "+e._s(e.$t("new_field"))+" ")]),e.fields?i("v-form",{attrs:{fields:e.directusFields,values:e.values,collection:"directus_collections"},on:{"stage-value":e.stageValue}}):e._e(),e.confirmRemove?i("portal",{attrs:{to:"modal"}},[i("v-confirm",{attrs:{color:"danger",message:e.$t("delete_collection_are_you_sure"),"confirm-text":e.$t("delete")},on:{cancel:function(t){e.confirmRemove=!1},confirm:e.remove}})],1):e._e(),e.confirmFieldRemove?i("portal",{attrs:{to:"modal"}},[i("v-confirm",{attrs:{color:"danger",message:e.$t("delete_field_are_you_sure",{field:e.fieldToBeRemoved}),"confirm-text":e.$t("delete")},on:{cancel:function(t){e.confirmFieldRemove=!1},confirm:function(t){return e.removeField(e.fieldToBeRemoved)}}})],1):e._e(),e.editingField?i("v-field-setup",{attrs:{"field-info":e.fieldBeingEdited,"collection-info":e.collectionInfo,saving:e.fieldSaving},on:{close:function(t){e.editingField=!1},save:e.setFieldSettings}}):e._e(),e.duplicatingField?i("v-field-duplicate",{attrs:{"field-information":e.fieldBeingDuplicated,"collection-information":e.collectionInfo},on:{close:function(t){e.duplicatingField=!1},save:e.duplicateFieldSettings}}):e._e(),i("v-info-sidebar",{attrs:{wide:""}},[i("span",{staticClass:"type-note"},[e._v("No settings")])])],1):i("not-found")},o=[],l=i("0122"),a=i("54f8"),s=i("d0ff"),r=i("d0af"),c=i("c964"),d=i("f3f3"),f=(i("99af"),i("4de4"),i("caad"),i("a4d3"),i("e01a"),i("b636"),i("d28b"),i("944a"),i("d81d"),i("fb6a"),i("4e82"),i("a434"),i("0c47"),i("23dc"),i("3410"),i("b0c0"),i("131a"),i("d3b7"),i("2532"),i("3ca3"),i("159b"),i("ddb0"),i("cde4")),u=i("2ef0"),h=i("1b32"),p=i.n(h),v=i("8dee"),m=i.n(v),y=i("4360"),_=i("d722"),g=i("f1d0"),b=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-modal",{attrs:{title:e.existing?e.$t("update_field")+": "+e.displayName:e.$t("create_field"),tabs:e.tabs,"active-tab":e.activeTab,buttons:e.buttons},on:{tab:function(t){e.activeTab=t},next:e.nextTab,close:function(t){return e.$emit("close")}}},[i("template",{slot:"interface"},[e.existing?e._e():i("h1",{staticClass:"type-heading-medium"},[e._v(" "+e._s(e.$t("field_setup_interface"))+" ")]),e.interfaceName?i("v-notice",{staticClass:"currently-selected",attrs:{color:"gray"}},[e._v(" "+e._s(e.$t("currently_selected",{thing:e.interfaces[e.interfaceName].name}))+" ")]):i("v-input",{staticClass:"interface-filter",attrs:{type:"text",placeholder:"Find an interface...","icon-left":"search",autofocus:""},model:{value:e.interfaceFilter,callback:function(t){e.interfaceFilter=t},expression:"interfaceFilter"}}),e.interfaceFilter?e._e():i("div",e._l(e.interfacesPopular,(function(t){return i("v-details",{key:t.title,attrs:{title:t.title,open:!0}},[i("div",{staticClass:"interfaces"},e._l(t.interfaces,(function(n){return i("article",{key:t.title+"-"+n.id,staticClass:"interface",class:{active:e.interfaceName===n.id},on:{click:function(t){return e.setInterface(n.id)}}},[i("div",{staticClass:"header"},[i("v-icon",{attrs:{name:n.icon||"category","x-large":"",color:"--white"}})],1),i("div",{staticClass:"body"},[i("h2",[e._v(e._s(n.name))]),i("p",[e._v(e._s(e.interfaceSubtitles(n)))])])])})),0)])})),1),i("div",[i("div",{staticClass:"interfaces"},e._l(e.interfacesFiltered,(function(t){return i("article",{key:"all-"+t.id,staticClass:"interface",class:{active:e.interfaceName===t.id},on:{click:function(i){return e.setInterface(t.id)}}},[i("div",{staticClass:"header"},[i("v-icon",{attrs:{name:t.icon||"category","x-large":"",color:"--white"}})],1),i("div",{staticClass:"body"},[i("h2",[e._v(e._s(t.name))]),i("p",[e._v(e._s(e.interfaceSubtitles(t)))])])])})),0)])],1),e.interfaceName?i("template",{slot:"schema"},[e.existing?e._e():i("h1",{staticClass:"type-heading-medium"},[e._v(" "+e._s(e.$t("field_setup_schema"))+" ")]),i("form",{staticClass:"schema",on:{submit:function(e){e.preventDefault()}}},[i("div",{staticClass:"name"},[i("label",[i("span",{staticClass:"type-label"},[e._v(e._s(e.$t("name")))]),i("v-icon",{staticClass:"required",attrs:{name:"star",color:"input-required-color",sup:""}}),i("v-input",{staticClass:"name-input",attrs:{autofocus:"",type:"text",placeholder:e.$t("db_column_name"),disabled:e.existing,"icon-right":e.iconToShow.icon,"icon-right-color":e.iconToShow.color,"icon-right-tooltip":e.iconToShow.tooltip,value:e.field},on:{input:function(t){e.field=e.slug(t,{replacement:"_",lower:!0}).trim()}}}),i("p",{staticClass:"type-note"},[e._v(" "+e._s(e.$t("display_name"))+": "),i("b",[e._v(e._s(e.$helpers.formatTitle(e.field||"...")))])])],1),i("label",[i("span",{staticClass:"type-label"},[e._v(e._s(e.$t("default_value")))]),i("v-input",{attrs:{type:"text",placeholder:"NULL",disabled:"o2m"===e.type||"translation"===e.type},model:{value:e.default_value,callback:function(t){e.default_value=t},expression:"default_value"}})],1)]),i("label",[i("span",{staticClass:"type-label"},[e._v(e._s(e.$t("note")))]),i("v-input",{attrs:{type:"text",placeholder:e.$t("add_note")},model:{value:e.note,callback:function(t){e.note=t},expression:"note"}})],1),i("div",{staticClass:"toggles"},[i("v-switch",{attrs:{disabled:e.fieldInfo.primary_key||"alias"===e.type,label:e.$t("required")},model:{value:e.required,callback:function(t){e.required=t},expression:"required"}}),i("v-switch",{attrs:{label:e.$t("readonly")},model:{value:e.readonly,callback:function(t){e.readonly=t},expression:"readonly"}})],1),i("details",{staticClass:"advanced",attrs:{open:e.existing}},[i("summary",[e._v(e._s(e.$t("advanced_options")))]),i("div",{staticClass:"advanced-form"},[i("label",[i("span",{staticClass:"type-label"},[e._v(e._s(e.$t("field_type")))]),i("v-simple-select",{model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},e._l(e.availableFieldTypes,(function(t){return i("option",{key:t,domProps:{value:t,selected:e.type===t}},[e._v(" "+e._s(e.$helpers.formatTitle(t))+" ")])})),0),i("small",{staticClass:"type-note"},[e._v(e._s(e.fieldTypeDescription))])],1),i("label",[i("span",{staticClass:"type-label"},[e._v(" "+e._s(e.$t("db_datatype",{db:e.$helpers.formatTitle(e.databaseVendor)}))+" ")]),i("v-simple-select",{model:{value:e.datatype,callback:function(t){e.datatype=t},expression:"datatype"}},e._l(e.availableDatatypes,(function(t){return i("option",{key:t,domProps:{value:t,selected:e.datatype===t}},[e._v(" "+e._s(t)+" ")])})),0),i("small",{staticClass:"type-note"},[e._v(" "+e._s(e.selectedDatatypeInfo&&e.$t(e.selectedDatatypeInfo.description))+" ")])],1),i("label",[i("span",{staticClass:"type-label"},[e._v(e._s(e.$t("length")))]),i("v-input",{attrs:{type:e.selectedDatatypeInfo&&e.selectedDatatypeInfo.decimal?"string":"number",value:e.lengthDisabled?null:e.length,disabled:e.lengthDisabled,placeholder:e.lengthDisabled?e.$t("length_disabled_placeholder"):""},on:{input:function(t){e.length=t}}})],1),i("label",[i("span",{staticClass:"type-label"},[e._v(e._s(e.$t("validation")))]),i("v-input",{attrs:{type:"text",placeholder:e.$t("regex")},model:{value:e.validation,callback:function(t){e.validation=t},expression:"validation"}})],1),i("v-switch",{attrs:{disabled:e.primaryKeyDisabled,label:e.$t("primary_key")},model:{value:e.primary_key,callback:function(t){e.primary_key=t},expression:"primary_key"}}),i("v-switch",{attrs:{label:e.$t("unique")},model:{value:e.unique,callback:function(t){e.unique=t},expression:"unique"}}),i("v-switch",{attrs:{label:e.$t("hidden_detail")},model:{value:e.hidden_detail,callback:function(t){e.hidden_detail=t},expression:"hidden_detail"}}),i("v-switch",{attrs:{label:e.$t("hidden_browse")},model:{value:e.hidden_browse,callback:function(t){e.hidden_browse=t},expression:"hidden_browse"}}),e.isNumeric?i("v-switch",{attrs:{label:e.$t("signed")},model:{value:e.signed,callback:function(t){e.signed=t},expression:"signed"}}):e._e(),i("label",{staticClass:"translation"},[i("span",{staticClass:"type-label"},[e._v(e._s(e.$t("translation")))]),i("v-ext-input",{attrs:{id:"repeater",name:"translation",type:"json",width:"full",options:{fields:[{field:"locale",type:"string",interface:"language",options:{limit:!0},width:"half"},{field:"translation",type:"string",interface:"text-input",options:{placeholder:e.$t("translated_field_name")},width:"half"}]}},model:{value:e.translation,callback:function(t){e.translation=t},expression:"translation"}})],1)],1)])])]):e._e(),e.selectedInterfaceInfo&&e.relation?i("template",{slot:"relation"},[e.existing?e._e():i("h1",{staticClass:"type-heading-medium"},[e._v(" "+e._s(e.$t("field_setup_relation"))+" ")]),"m2o"===e.relation?i("form",{staticClass:"single"},[i("span",{staticClass:"type-label"},[e._v(e._s(e.$t("this_collection")))]),i("v-simple-select",{staticClass:"select",attrs:{value:e.relationInfo.collection_many,disabled:""}},[i("option",{attrs:{selected:""},domProps:{value:e.collectionInfo.collection}},[e._v(" "+e._s(e.collectionInfo.collection)+" ")])]),i("v-simple-select",{staticClass:"select",attrs:{value:e.relationInfo.field_many,disabled:""}},[i("option",{attrs:{selected:""},domProps:{value:e.field}},[e._v(e._s(e.field))])]),i("v-icon",{attrs:{name:"arrow_backward"}}),i("span",{staticClass:"type-label"},[e._v(e._s(e.$t("related_collection")))]),i("v-simple-select",{staticClass:"select",model:{value:e.relationInfo.collection_one,callback:function(t){e.$set(e.relationInfo,"collection_one",t)},expression:"relationInfo.collection_one"}},[i("optgroup",{attrs:{label:e.$tc("collection",2)}},e._l(e.collectionsGrouped.user,(function(t){return i("option",{key:t,domProps:{value:t}},[e._v(" "+e._s(t)+" ")])})),0),i("optgroup",{attrs:{label:"Directus"}},e._l(e.collectionsGrouped.system,(function(t){return i("option",{key:t,domProps:{value:t}},[e._v(" "+e._s(t)+" ")])})),0)]),i("v-simple-select",{staticClass:"select",attrs:{value:e.primaryKeyFieldByCollection(e.relationInfo.collection_one).field,disabled:""}},[i("option",{attrs:{selected:""},domProps:{value:e.primaryKeyFieldByCollection(e.relationInfo.collection_one).field}},[e._v(" "+e._s(e.primaryKeyFieldByCollection(e.relationInfo.collection_one).field)+" ")])])],1):e._e(),"o2m"===e.relation?i("form",{staticClass:"single"},[i("span",{staticClass:"type-label"},[e._v(e._s(e.$t("this_collection")))]),i("v-simple-select",{staticClass:"select",attrs:{value:e.collectionInfo.collection,disabled:""}},[i("option",{attrs:{selected:""},domProps:{value:e.collectionInfo.collection}},[e._v(" "+e._s(e.collectionInfo.collection)+" ")])]),i("v-simple-select",{staticClass:"select",attrs:{value:e.primaryKeyField.field,disabled:""}},[i("option",{attrs:{selected:""},domProps:{value:e.primaryKeyField.field}},[e._v(" "+e._s(e.primaryKeyField.field)+" ")])]),i("v-icon",{attrs:{name:"arrow_forward"}}),i("span",{staticClass:"type-label"},[e._v(e._s(e.$t("related_collection")))]),i("v-simple-select",{staticClass:"select",model:{value:e.relationInfo.collection_many,callback:function(t){e.$set(e.relationInfo,"collection_many",t)},expression:"relationInfo.collection_many"}},[i("optgroup",{attrs:{label:e.$tc("collection",2)}},e._l(e.collectionsGrouped.user,(function(t){return i("option",{key:t,domProps:{value:t}},[e._v(" "+e._s(t)+" ")])})),0),i("optgroup",{attrs:{label:"Directus"}},e._l(e.collectionsGrouped.system,(function(t){return i("option",{key:t,domProps:{value:t}},[e._v(" "+e._s(t)+" ")])})),0)]),i("v-simple-select",{staticClass:"select",model:{value:e.relationInfo.field_many,callback:function(t){e.$set(e.relationInfo,"field_many",t)},expression:"relationInfo.field_many"}},e._l(e.fieldsNonSystem(e.relationInfo.collection_many),(function(t){var n=t.field;return i("option",{key:n,domProps:{value:n}},[e._v(" "+e._s(n)+" ")])})),0)],1):e._e(),"m2m"===e.relation?i("form",{staticClass:"full"},[i("p",{staticClass:"type-label"},[e._v(e._s(e.$t("this_collection")))]),i("v-simple-select",{staticClass:"select",attrs:{value:e.collectionInfo.collection,disabled:""}},[i("option",{attrs:{selected:""},domProps:{value:e.collectionInfo.collection}},[e._v(" "+e._s(e.collectionInfo.collection)+" ")])]),i("v-simple-select",{staticClass:"select",attrs:{value:e.primaryKeyField.field,disabled:""}},[i("option",{attrs:{selected:""},domProps:{value:e.primaryKeyField.field}},[e._v(" "+e._s(e.primaryKeyField.field)+" ")])]),i("v-icon",{attrs:{name:"arrow_forward"}}),i("p",{staticClass:"type-label"},[e._v(e._s(e.$t("junction_collection")))]),e.createM2Mjunction?e._e():i("v-simple-select",{staticClass:"select",model:{value:e.junctionNameM2M,callback:function(t){e.junctionNameM2M=t},expression:"junctionNameM2M"}},[i("optgroup",{attrs:{label:e.$tc("collection",2)}},e._l(e.collectionsGrouped.user,(function(t){return i("option",{key:t,domProps:{value:t}},[e._v(" "+e._s(t)+" ")])})),0),i("optgroup",{attrs:{label:"Directus"}},e._l(e.collectionsGrouped.system,(function(t){return i("option",{key:t,domProps:{value:t}},[e._v(" "+e._s(t)+" ")])})),0)]),e.createM2Mjunction?i("v-input",{staticClass:"select",attrs:{type:"text",placeholder:e.autoM2Msuggestion(e.collectionInfo.collection,e.relationInfoM2M[0==e.currentM2MIndex?1:0].collection_one)},model:{value:e.junctionNameM2M,callback:function(t){e.junctionNameM2M=t},expression:"junctionNameM2M"}}):e._e(),e.createM2Mjunction?e._e():i("v-simple-select",{staticClass:"select",model:{value:e.relationInfoM2M[e.currentM2MIndex].field_many,callback:function(t){e.$set(e.relationInfoM2M[e.currentM2MIndex],"field_many",t)},expression:"relationInfoM2M[currentM2MIndex].field_many"}},e._l(e.fields(e.relationInfoM2M[0].collection_many),(function(t){var n=t.field;return i("option",{key:n,domProps:{value:n}},[e._v(" "+e._s(n)+" ")])})),0),e.createM2Mjunction?i("v-input",{staticClass:"select",attrs:{type:"text",placeholder:e.autoM2Msuggestion(e.collectionInfo.collection,"id")},model:{value:e.relationInfoM2M[e.currentM2MIndex].field_many,callback:function(t){e.$set(e.relationInfoM2M[e.currentM2MIndex],"field_many",t)},expression:"relationInfoM2M[currentM2MIndex].field_many"}}):e._e(),e.createM2Mjunction?e._e():i("v-simple-select",{staticClass:"select",model:{value:e.relationInfoM2M[0===e.currentM2MIndex?1:0].field_many,callback:function(t){e.$set(e.relationInfoM2M[0===e.currentM2MIndex?1:0],"field_many",t)},expression:"relationInfoM2M[currentM2MIndex === 0 ? 1 : 0].field_many"}},e._l(e.fields(e.relationInfoM2M[0].collection_many),(function(t){var n=t.field;return i("option",{key:n,domProps:{value:n}},[e._v(" "+e._s(n)+" ")])})),0),e.createM2Mjunction?i("v-input",{staticClass:"select",attrs:{type:"text",placeholder:e.autoM2Msuggestion(e.relationInfoM2M[0==e.currentM2MIndex?1:0].collection_one,"id")},model:{value:e.relationInfoM2M[0===e.currentM2MIndex?1:0].field_many,callback:function(t){e.$set(e.relationInfoM2M[0===e.currentM2MIndex?1:0],"field_many",t)},expression:"relationInfoM2M[currentM2MIndex === 0 ? 1 : 0].field_many"}}):e._e(),e.existing?e._e():i("v-checkbox",{attrs:{id:"createM2Mjunction",value:"m2mjunction",label:e.$t("auto_generate")},model:{value:e.createM2Mjunction,callback:function(t){e.createM2Mjunction=t},expression:"createM2Mjunction"}}),i("v-icon",{attrs:{name:"arrow_backward"}}),i("p",{staticClass:"type-label"},[e._v(e._s(e.$t("related_collection")))]),i("v-simple-select",{staticClass:"select",model:{value:e.relationInfoM2M[0==e.currentM2MIndex?1:0].collection_one,callback:function(t){e.$set(e.relationInfoM2M[0==e.currentM2MIndex?1:0],"collection_one",t)},expression:"relationInfoM2M[currentM2MIndex == 0 ? 1 : 0].collection_one"}},[i("optgroup",{attrs:{label:e.$tc("collection",2)}},e._l(e.collectionsGrouped.user,(function(t){return i("option",{key:t,domProps:{value:t}},[e._v(" "+e._s(t)+" ")])})),0),i("optgroup",{attrs:{label:"Directus"}},e._l(e.collectionsGrouped.system,(function(t){return i("option",{key:t,domProps:{value:t}},[e._v(" "+e._s(t)+" ")])})),0)]),i("v-simple-select",{staticClass:"select",attrs:{value:e.primaryKeyFieldByCollection(e.relationInfoM2M[0===e.currentM2MIndex?1:0].collection_one).field,disabled:""}},[i("option",{attrs:{selected:""},domProps:{value:e.primaryKeyFieldByCollection(e.relationInfoM2M[0===e.currentM2MIndex?1:0].collection_one).field}},[e._v(" "+e._s(e.primaryKeyFieldByCollection(e.relationInfoM2M[0===e.currentM2MIndex?1:0].collection_one).field)+" ")])])],1):e._e()]):e._e(),i("template",{slot:"options"},[e.existing?e._e():i("h1",{staticClass:"type-heading-medium"},[e._v(" "+e._s(e.$t("field_setup_options"))+" ")]),i("label",{staticClass:"type-label",attrs:{for:"__width"}},[e._v(e._s(e.$t("field_width")))]),i("v-simple-select",{attrs:{name:"__width"},model:{value:e.width,callback:function(t){e.width=t},expression:"width"}},[i("option",{attrs:{value:"half"}},[e._v(e._s(e.$t("field_width_half")))]),i("option",{attrs:{value:"half-left"}},[e._v(e._s(e.$t("field_width_left")))]),i("option",{attrs:{value:"half-right"}},[e._v(e._s(e.$t("field_width_right")))]),i("option",{attrs:{value:"full"}},[e._v(e._s(e.$t("field_width_full")))]),i("option",{attrs:{value:"fill"}},[e._v(e._s(e.$t("field_width_fill")))])]),i("p",{staticClass:"note type-note"},[e._v(e._s(e.$t("field_width_note")))]),e.selectedInterfaceInfo?i("form",{staticClass:"options",on:{submit:function(e){e.preventDefault()}}},[e._l(e.interfaceOptions.regular,(function(t,n){return i("div",{key:n,staticClass:"options"},[i("label",{staticClass:"type-label",attrs:{for:n}},[e._v(e._s(t.name))]),i("v-ext-input",{attrs:{id:t.interface,name:n,type:t.type,length:t.length,readonly:t.readonly,required:t.required,loading:t.loading,options:t.options,value:e.options[n],fields:e.selectedInterfaceInfo.options,values:e.options},on:{input:function(t){return e.$set(e.options,n,t)}}}),i("p",{staticClass:"note type-note",domProps:{innerHTML:e._s(e.$helpers.snarkdown(t.comment||""))}})],1)})),Object.keys(e.interfaceOptions.advanced).length>0?i("details",{staticClass:"advanced",attrs:{open:e.existing}},[i("summary",[e._v(e._s(e.$t("advanced_options")))]),e._l(e.interfaceOptions.advanced,(function(t,n){return i("div",{key:n,staticClass:"options"},[i("label",{staticClass:"type-label",attrs:{for:n}},[e._v(e._s(t.name))]),i("v-ext-input",{attrs:{id:t.interface,name:n,type:t.type,length:t.length,readonly:t.readonly,required:t.required,loading:t.loading,options:t.options,value:e.options[n]||t.default,fields:e.selectedInterfaceInfo.options,values:e.options},on:{input:function(t){return e.$set(e.options,n,t)}}}),i("p",{staticClass:"note type-note",domProps:{innerHTML:e._s(e.$helpers.snarkdown(t.comment||""))}})],1)}))],2):e._e()],2):e._e()],1)],2)},M=[],I=(i("b64b"),i("07ac"),i("ac1f"),i("25f0"),i("5319"),i("2ca0"),i("37b6")),$=i("d3bd"),j=i.n($),w={name:"VFieldSetup",props:{collectionInfo:{type:Object,required:!0},fieldInfo:{type:Object,required:!0},saving:{type:Boolean,default:!1}},data:function(){return{activeTab:"interface",id:null,sort:null,field:null,isFieldValid:null,datatype:null,type:null,interfaceName:null,interfaceFilter:null,options:{},translation:{},readonly:!1,required:!1,unique:!1,note:null,hidden_detail:!1,hidden_browse:!1,primary_key:!1,signed:!0,width:"full",length:null,default_value:null,validation:null,relationInfo:{id:null,collection_many:null,field_many:null,collection_one:null,field_one:null},relationInfoM2M:[{id:null,collection_many:null,field_many:null,collection_one:null,field_one:null,junction_field:null},{id:null,collection_many:null,field_many:null,collection_one:null,field_one:null,junction_field:null}],createM2Mjunction:!1,junctionNameM2M:null}},computed:{iconToShow:function(){return!this.field||this.existing?{icon:null,color:null}:this.isFieldValid?{icon:"done",color:"success"}:{icon:"error",color:"danger",tooltip:this.$t("field_already_exists",{field:"'"+this.field+"'"})}},collections:function(){return Object(u["cloneDeep"])(this.$store.state.collections)},collectionsGrouped:function(){var e=["directus_collections","directus_activity","directus_fields","directus_relations"],t=Object.keys(this.collections),i=t.filter((function(t){return t.startsWith("directus_")&&!e.includes(t)})),n=t.filter((function(e){return!e.startsWith("directus_")}));return{system:i,user:n}},interfaces:function(){return Object(u["cloneDeep"])(this.$store.state.extensions.interfaces)},interfacesPopular:function(){var e=this,t=[{title:this.$t("popular"),interfaces:["text-input","textarea","wysiwyg","switch","datetime","calendar","file","many-to-one"]}];return t.map((function(t){return Object(d["a"])(Object(d["a"])({},t),{},{interfaces:t.interfaces.map((function(t){return e.interfaces[t]}))})}))},interfacesFiltered:function(){var e=this;return this.interfaceFilter?Object.keys(this.interfaces).filter((function(t){return p()(t).toLowerCase().includes(e.interfaceFilter.toLowerCase())})).map((function(t){return Object(d["a"])({},e.interfaces[t])})):this.interfaces},databaseVendor:function(){return Object(u["cloneDeep"])(this.$store.state.serverInfo.databaseVendor)},primaryKeyDisabled:function(){return!!this.primaryKeyField},primaryKeyTooltip:function(){return this.primaryKeyField?this.field===this.primaryKeyField.field?this.$t("cant_disable_primary"):this.$t("max_one_primary_key"):null},selectedInterfaceInfo:function(){return this.interfaceName?Object.assign({},this.interfaces[this.interfaceName]):null},interfaceOptions:function(){if(!this.selectedInterfaceInfo)return null;var e=Object.assign({},this.selectedInterfaceInfo.options),t=Object(u["pickBy"])(e,(function(e){return!e.advanced})),i=Object(u["pickBy"])(e,(function(e){return!0===e.advanced}));return{regular:t,advanced:i}},existing:function(){return null!==this.id},schemaDisabled:function(){return!(this.interfaceName&&this.interfaceName.length>0)},optionsDisabled:function(){return!0===this.schemaDisabled||!this.field},displayName:function(){return this.field?this.$helpers.formatTitle(this.field):""},availableFieldTypes:function(){return this.interfaceName&&this.interfaces[this.interfaceName]&&this.interfaces[this.interfaceName].types||[]},availableDatatypes:function(){return this.type?0===this.availableFieldTypes.length?[]:f["b"][this.type][this.databaseVendor].datatypes:[]},selectedDatatypeInfo:function(){return f["a"][this.databaseVendor][this.datatype]},fieldTypeDescription:function(){return this.type?f["b"][this.type]&&this.$t(f["b"][this.type].description):null},lengthDisabled:function(){return(!this.selectedDatatypeInfo||!0!==this.selectedDatatypeInfo.length)&&(!this.selectedDatatypeInfo||!0!==this.selectedDatatypeInfo.decimal)},relation:function(){if(!this.selectedInterfaceInfo)return null;if(!this.selectedInterfaceInfo.relation)return null;var e,t=["file","user"];return e="string"===typeof this.selectedInterfaceInfo.relation?this.selectedInterfaceInfo.relation:this.selectedInterfaceInfo.relation.type,t.includes(e)&&(e=null),e},buttons:function(){var e=!1;"interface"!==this.activeTab||this.interfaceName||(e=!0),"schema"!==this.activeTab||this.field||(e=!0),this.fieldValid&&!this.existing&&(e=!0);var t=this.$t("next");return("options"===this.activeTab||"schema"===this.activeTab&&!1===this.hasOptions||this.existing)&&(t=this.$t("save")),{next:{disabled:e,text:t,loading:this.saving}}},tabs:function(){var e={interface:{text:this.$tc("interface",1)},schema:{text:this.$t("schema"),disabled:!(this.interfaceName&&this.interfaceName.length>0)}};return this.relation&&(e.relation={text:this.$t("relation"),disabled:!0===this.schemaDisabled||!this.field}),e.options={text:this.$t("options"),disabled:!0===this.schemaDisabled||!this.field},e},hasOptions:function(){var e=this.selectedInterfaceInfo&&this.selectedInterfaceInfo.options||{};return!!(this.interfaceName&&Object.keys(e).length>0)},primaryKeyField:function(){return Object(u["find"])(this.collectionInfo.fields,{primary_key:!0})},currentM2MIndex:function(){var e=this,t=Object(u["findIndex"])(this.relationInfoM2M,(function(t){return t.collection_one===e.collectionInfo.collection}));return-1===t?0:t},isNumeric:function(){return"integer"===this.type}},watch:{fieldInfo:function(){this.useFieldInfo()},interfaceName:function(e,t){var i=this;if(e){if(e!==this.fieldInfo.interface){var n=Object(d["a"])(Object(d["a"])({},this.interfaceOptions.advanced),this.interfaceOptions.regular);Object(u["forEach"])(n,(function(e,t){i.$set(i.options,t,e.default)}))}if((!this.existing||null!=t)&&(this.type=this.availableFieldTypes[0],this.datatype=this.type?f["b"][this.type][this.databaseVendor].default:null,!this.existing)){if(this.selectedInterfaceInfo&&this.selectedInterfaceInfo.recommended){var o=this.selectedInterfaceInfo.recommended,l=o.defaultValue,a=o.length,s=o.validation,r=o.required;l&&(this.default_value=l),a&&(this.length=a),s&&(this.validation=s),void 0!==r&&(this.required=r)}this.initRelation()}}},type:function(e){this.existing||e&&(this.datatype=f["b"][e][this.databaseVendor].default,this.length>255&&"string"===this.type.toLowerCase()&&(this.datatype="TEXT"))},datatype:function(){this.existing&&null!==this.length||(this.selectedInterfaceInfo&&this.selectedInterfaceInfo.recommended&&this.selectedInterfaceInfo.recommended.length?this.length=this.selectedInterfaceInfo.recommended.length:(this.selectedDatatypeInfo&&this.selectedDatatypeInfo.length&&(this.length=this.selectedDatatypeInfo.defaultLength,f["b"][this.type][this.databaseVendor].length&&(this.length=f["b"][this.type][this.databaseVendor].length)),this.selectedDatatypeInfo&&this.selectedDatatypeInfo.decimal&&(this.length=this.selectedDatatypeInfo.defaultDigits+","+this.selectedDatatypeInfo.defaultDecimals)))},lengthDisabled:function(e){e&&(this.length=null)},field:function(e){this.isFieldValid=!Object.keys(this.collectionInfo.fields).includes(e),this.relation&&("m2o"===this.relation&&(this.relationInfo.field_many=this.field),"o2m"===this.relation&&(this.relationInfo.field_one=this.field))},relationInfoM2M:{deep:!0,handler:function(){if(this.createM2Mjunction){var e=this.relationInfoM2M[0].field_many=this.validateFieldName(this.relationInfoM2M[0].field_many),t=this.relationInfoM2M[1].field_many=this.validateFieldName(this.relationInfoM2M[1].field_many);this.relationInfoM2M[0].junction_field=t,this.relationInfoM2M[1].junction_field=e}else this.relationInfoM2M[0].junction_field=this.relationInfoM2M[1].field_many,this.relationInfoM2M[1].junction_field=this.relationInfoM2M[0].field_many;this.relationInfoM2M[this.currentM2MIndex].field_one=this.field}},relationInfo:{deep:!0,handler:function(){"o2m"===this.relation&&this.getM2OID()}},createM2Mjunction:function(e){if(e){var t=this.currentM2MIndex,i=this.collectionInfo.collection;this.relationInfoM2M[t].field_one=i,this.relationInfoM2M[0===t?1:0].field_one=i,this.junctionNameM2M=this.autoM2Msuggestion(i,this.relationInfoM2M[0==t?1:0].collection_one),this.relationInfoM2M[t].field_many=this.autoM2Msuggestion(i,"id"),this.relationInfoM2M[0===t?1:0].field_many=this.autoM2Msuggestion(this.relationInfoM2M[0==t?1:0].collection_one,"id")}else this.initRelation()},junctionNameM2M:function(e){if(this.createM2Mjunction){var t=this.validateFieldName(e);this.junctionNameM2M=t,this.relationInfoM2M[0].collection_many=t,this.relationInfoM2M[1].collection_many=t}else this.relationInfoM2M[0].collection_many=e,this.relationInfoM2M[1].collection_many=e}},created:function(){this.useFieldInfo(),this.initRelation(),this.activeTab=this.existing?"options":"interface"},methods:{slug:j.a,interfaceSubtitles:function(e){return e.types?this.$helpers.formatTitle(e.types[0]):"String"},nextTab:function(){if(this.existing)return this.saveField();switch(this.activeTab){case"interface":this.activeTab="schema";break;case"schema":if(this.relation)return this.activeTab="relation";if(!1===this.hasOptions)return this.saveField();this.activeTab="options";break;case"relation":if(!1===this.hasOptions)return this.saveField();this.activeTab="options";break;case"options":default:this.saveField();break}},setInterface:function(e){this.interfaceName=e,this.existing||this.nextTab()},saveField:function(){var e={id:this.id,sort:this.sort,field:this.field,type:this.type,datatype:this.datatype,interface:this.interfaceName,default_value:this.default_value,options:this.options,readonly:this.readonly,required:this.required,unique:this.unique,note:this.note,hidden_detail:this.hidden_detail,hidden_browse:this.hidden_browse,primary_key:this.primary_key,validation:this.validation,width:this.width,translation:this.translation};!1===this.lengthDisabled&&(e.length=this.length),!0===this.isNumeric&&(e.signed=this.signed);var t={fieldInfo:e,relation:null};this.relation&&("m2o"===this.relation&&(t.relation=Object(d["a"])({},this.relationInfo),delete t.relation.field_one),"o2m"===this.relation&&(t.relation=Object(d["a"])({},this.relationInfo)),"m2m"===this.relation&&(t.relation=Object(s["a"])(this.relationInfoM2M),!0===this.createM2Mjunction&&this.createM2MjunctionCollection())),this.$emit("save",t)},useFieldInfo:function(){var e=this;if(this.fieldInfo&&0!==Object.keys(this.fieldInfo).length){var t=this.fieldInfo.field,i=this.collectionInfo.collection,n=Object(u["cloneDeep"])(this.$store.state.collections[i].fields[t]);Object.keys(n).forEach((function(t){null!=n[t]&&(e[t]=n[t])})),this.interfaceName=n.interface,this.type=this.type&&this.type.toLowerCase(),this.datatype=this.datatype&&this.datatype.toUpperCase()}},initRelation:function(){var e=this;if(this.relation){var t=this.collectionInfo.collection,i=this.field;if("m2o"===this.relation){var n=Object(u["cloneDeep"])(this.$store.getters.m2o(t,i));n?Object(u["forEach"])(n,(function(t,i){return i&&t&&i.startsWith("collection")?e.$set(e.relationInfo,i,t.collection):i&&t&&i.startsWith("field")?e.$set(e.relationInfo,i,t.field):void(t&&e.$set(e.relationInfo,i,t))})):(this.relationInfo.collection_many=this.collectionInfo.collection,this.relationInfo.field_many=this.field,this.relationInfo.collection_one=Object.values(Object(u["cloneDeep"])(this.$store.state.collections))[0].collection,this.relationInfo.field_one=Object(u["find"])(Object.values(Object(u["cloneDeep"])(this.$store.state.collections))[0].fields,{primary_key:!0}).field)}else if("o2m"===this.relation){var o=Object(u["cloneDeep"])(this.$store.getters.o2m(t,i));o?Object(u["forEach"])(o,(function(t,i){return i&&t&&i.startsWith("collection")?e.$set(e.relationInfo,i,t.collection):i&&t&&i.startsWith("field")?e.$set(e.relationInfo,i,t.field):void(t&&e.$set(e.relationInfo,i,t))})):(this.relationInfo.collection_one=this.collectionInfo.collection,this.relationInfo.field_one=this.field,this.relationInfo.collection_many=Object.values(Object(u["cloneDeep"])(this.$store.state.collections))[0].collection,this.relationInfo.field_many=Object(u["find"])(Object.values(Object(u["cloneDeep"])(this.$store.state.collections))[0].fields,{primary_key:!1}).field,this.getM2OID())}else if("m2m"===this.relation){var a=Object(u["cloneDeep"])(this.$store.getters.o2m(t,i));i&&a?(this.junctionNameM2M=a.collection_many.collection,this.relationInfoM2M[0].id=a.id,this.relationInfoM2M[0].field_many=a.field_many.field,this.relationInfoM2M[0].collection_one=a.collection_one.collection,this.relationInfoM2M[0].field_one=a.field_one.field,this.relationInfoM2M[0].junction_field=a.junction.field_many.field,this.relationInfoM2M[1].id=a.junction.id,this.relationInfoM2M[1].field_many=a.junction.field_many.field,this.relationInfoM2M[1].collection_one=a.junction.collection_one.collection,this.relationInfoM2M[1].field_one=a.junction.field_one&&a.junction.field_one.field,this.relationInfoM2M[1].junction_field=a.field_many.field):(this.junctionNameM2M=Object.keys(this.collections)[0],this.relationInfoM2M[0].field_many=Object.values(Object.values(this.collections)[0].fields)[0].field,this.relationInfoM2M[0].collection_one=this.collectionInfo.collection,this.relationInfoM2M[0].junction_field=Object.values(Object.values(this.collections)[0].fields)[0].field,this.relationInfoM2M[1].field_many=Object.values(Object.values(this.collections)[0].fields)[0].field,this.relationInfoM2M[1].collection_one=Object.keys(this.collections)[1],this.relationInfoM2M[1].junction_field=Object.values(Object.values(this.collections)[0].fields)[0].field,this.selectedInterfaceInfo.relation&&"object"===Object(l["a"])(this.selectedInterfaceInfo.relation)&&this.selectedInterfaceInfo.relation.relatedCollection&&(this.relationInfoM2M[1].collection_one=this.selectedInterfaceInfo.relation.relatedCollection))}}},getM2OID:function(){var e=this.relationInfo.collection_many,t=this.relationInfo.field_many,i=Object(u["cloneDeep"])(this.$store.getters.m2o(e,t));this.relationInfo.id=i?i.id:null},fields:function(e){return e?this.collections[e].fields:{}},fieldsNonSystem:function(e){if(!e)return{};var t=this.collections[e].fields;for(var i in t)t.hasOwnProperty(i)&&t[i].primary_key&&delete t[i];return this.collections[e].fields},primaryKeyFieldByCollection:function(e){var t=this.fields(e);return Object(u["find"])(t,{primary_key:!0})},validateFieldName:function(e){return e.toString().replace(/\s+/g,"_").replace(/[^\w_]+/g,"").replace(/__+/g,"_").toLowerCase()},autoM2Msuggestion:function(e,t){return e+"_"+t},createM2MjunctionCollection:function(){var e=this,t={collection:this.junctionNameM2M,hidden:!0,note:this.$t("junction_collection"),fields:[{field:"id",type:"integer",datatype:"int",interface:"primary-key",primary_key:!0,auto_increment:!0,signed:!1,length:10},{field:this.relationInfoM2M[0].field_many,type:this.primaryKeyFieldByCollection(this.relationInfoM2M[0].collection_one).type,length:10,datatype:this.primaryKeyFieldByCollection(this.relationInfoM2M[0].collection_one).datatype,interface:null,readonly:!1,required:!0},{field:this.relationInfoM2M[1].field_many,type:this.primaryKeyFieldByCollection(this.relationInfoM2M[1].collection_one).type,length:10,datatype:this.primaryKeyFieldByCollection(this.relationInfoM2M[1].collection_one).datatype,interface:null,readonly:!1,required:!0}]},i={id:{auto_increment:!0,collection:this.junctionNameM2M,datatype:"int",default_value:null,field:"id",group:null,hidden_detail:!0,hidden_browse:!0,interface:"primary-key",length:"10",locked:0,note:null,options:null,primary_key:!0,readonly:0,required:!1,signed:!1,sort:1,translation:null,type:"integer",unique:!1,validation:null,width:4}};i[this.relationInfoM2M[0].field_many]={collection:this.junctionNameM2M,field:this.relationInfoM2M[0].field_many,datatype:this.primaryKeyFieldByCollection(this.relationInfoM2M[0].collection_one).datatype,unique:!1,primary_key:!1,auto_increment:!1,default_value:null,note:null,signed:!0,type:this.primaryKeyFieldByCollection(this.relationInfoM2M[0].collection_one).type,sort:0,interface:null,hidden_detail:!0,hidden_browse:!0,required:!0,options:null,locked:!1,translation:null,readonly:!1,width:4,validation:null,group:null,length:10},i[this.relationInfoM2M[1].field_many]={collection:this.junctionNameM2M,field:this.relationInfoM2M[1].field_many,datatype:this.primaryKeyFieldByCollection(this.relationInfoM2M[1].collection_one).datatype,unique:!1,primary_key:!1,auto_increment:!1,default_value:null,note:null,signed:!0,type:this.primaryKeyFieldByCollection(this.relationInfoM2M[1].collection_one).type,sort:0,interface:null,hidden_detail:!0,hidden_browse:!0,required:!0,options:null,locked:!1,translation:null,readonly:!1,width:4,validation:null,group:null,length:10},this.$api.createCollection(t,{fields:"*.*"}).then((function(e){return e.data})).then((function(t){e.$store.dispatch("addCollection",Object(d["a"])(Object(d["a"])({},t),{},{fields:i})),e.$store.dispatch("addPermission",{collection:e.junctionNameM2M,permission:Object(d["a"])({$create:I["a"]},I["a"])})})).catch((function(t){e.$events.emit("error",{notify:e.$t("something_went_wrong_body"),error:t})}))}}},x=w,k=(i("c531"),i("2877")),F=Object(k["a"])(x,b,M,!1,null,"d55c2a0e",null),C=F.exports,O=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-modal",{attrs:{title:e.$t("duplicating_field")+": "+e.$helpers.formatField(e.fieldInfo.field,e.fieldInfo.collection),buttons:e.buttons},on:{save:function(t){return e.saveField()},close:function(t){return e.$emit("close")}}},[i("form",{staticClass:"options",on:{submit:function(e){e.preventDefault()}}},[i("div",{staticClass:"options"},[i("label",[e._v(" "+e._s(e.$tc("collection",1))+" "),i("v-simple-select",{attrs:{required:""},model:{value:e.selectedCollection,callback:function(t){e.selectedCollection=t},expression:"selectedCollection"}},e._l(Object.keys(this.collections),(function(t){return i("option",{key:t,domProps:{value:t,selected:t===e.selectedCollection}},[e._v(" "+e._s(e.$helpers.formatTitle(t))+" ")])})),0)],1)]),i("div",{staticClass:"options"},[i("label",[e._v(" "+e._s(e.$tc("field",1)+" "+e.$t("name"))+" "),i("v-input",{attrs:{required:"",value:e.field,placeholder:e.fieldInfo.field,"icon-right":e.iconToShow.icon,"icon-right-color":e.iconToShow.color,"icon-right-tooltip":e.iconToShow.tooltip},model:{value:e.field,callback:function(t){e.field=t},expression:"field"}})],1),i("p",{staticClass:"small-text"},[e._v(" "+e._s(e.$t("display_name"))+": "),i("b",[e._v(e._s(e.$helpers.formatTitle(e.field||"...")))])])])])])},D=[],N={name:"VFieldDuplicate",props:{collectionInformation:{type:Object,required:!0},fieldInformation:{type:Object,required:!0}},data:function(){return{fieldInfo:Object.assign({},this.fieldInformation),selectedCollection:this.collectionInformation.collection,field:null,saving:!1}},computed:{databaseVendor:function(){return Object(u["cloneDeep"])(this.$store.state.serverInfo.databaseVendor)},selectedDatatypeInfo:function(){return f["a"][this.databaseVendor][this.fieldInfo.datatype]},lengthDisabled:function(){return(!this.selectedDatatypeInfo||!0!==this.selectedDatatypeInfo.length)&&(!this.selectedDatatypeInfo||!0!==this.selectedDatatypeInfo.decimal)},canDuplicate:function(){return!!(this.field&&this.isFieldValid&&this.selectedCollection)},iconToShow:function(){return this.field?this.isFieldValid?{icon:"done",color:"success"}:{icon:"error",color:"danger",tooltip:this.$t("field_already_exists",{field:"'"+this.field+"'"})}:{icon:null,color:null}},isFieldValid:function(){var e=this,t=!0;return Object.keys(this.collections[this.selectedCollection].fields).forEach((function(i){i===e.field&&(t=!1)})),!!t},collectionFieldCount:function(){return Object.keys(this.collections[this.selectedCollection].fields).length},collections:function(){var e=Object.assign({},this.$store.state.collections);return Object.keys(e).filter((function(e){return!1===e.startsWith("directus_")})).reduce((function(t,i){return t[i]=e[i],t}),{})},buttons:function(){return{save:{disabled:!this.canDuplicate,text:this.$t("create"),loading:this.saving}}}},watch:{field:function(e){this.field=e.toString().toLowerCase().replace(/\s+/g,"_").replace(/[^\w_]+/g,"").replace(/__+/g,"_")}},methods:{saveField:function(){this.saving=!0;var e=this.fieldInfo;e.field=this.field,e.sort=this.collectionFieldCount+1,delete e.id,delete e.name,!0===this.lengthDisabled&&delete e.length;var t={fieldInfo:e,collection:this.selectedCollection};this.$emit("save",t)}}},T=N,S=(i("e7c8"),Object(k["a"])(T,O,D,!1,null,"07160082",null)),P=S.exports,E=i("2f62");function L(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */L=function(){return t};var e,t={},i=Object.prototype,n=i.hasOwnProperty,o=Object.defineProperty||function(e,t,i){e[t]=i.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",r=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function d(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,i){return e[t]=i}}function f(e,t,i,n){var l=t&&t.prototype instanceof _?t:_,a=Object.create(l.prototype),s=new D(n||[]);return o(a,"_invoke",{value:k(e,i,s)}),a}function u(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}t.wrap=f;var h="suspendedStart",p="suspendedYield",v="executing",m="completed",y={};function _(){}function g(){}function b(){}var M={};d(M,s,(function(){return this}));var I=Object.getPrototypeOf,$=I&&I(I(N([])));$&&$!==i&&n.call($,s)&&(M=$);var j=b.prototype=_.prototype=Object.create(M);function w(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function i(o,a,s,r){var c=u(e[o],e,a);if("throw"!==c.type){var d=c.arg,f=d.value;return f&&"object"==Object(l["a"])(f)&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){i("next",e,s,r)}),(function(e){i("throw",e,s,r)})):t.resolve(f).then((function(e){d.value=e,s(d)}),(function(e){return i("throw",e,s,r)}))}r(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){i(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function k(t,i,n){var o=h;return function(l,a){if(o===v)throw new Error("Generator is already running");if(o===m){if("throw"===l)throw a;return{value:e,done:!0}}for(n.method=l,n.arg=a;;){var s=n.delegate;if(s){var r=F(s,n);if(r){if(r===y)continue;return r}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=u(t,i,n);if("normal"===c.type){if(o=n.done?m:p,c.arg===y)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function F(t,i){var n=i.method,o=t.iterator[n];if(o===e)return i.delegate=null,"throw"===n&&t.iterator.return&&(i.method="return",i.arg=e,F(t,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var l=u(o,t.iterator,i.arg);if("throw"===l.type)return i.method="throw",i.arg=l.arg,i.delegate=null,y;var a=l.arg;return a?a.done?(i[t.resultName]=a.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,y):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,y)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function N(t){if(t||""===t){var i=t[s];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function i(){for(;++o<t.length;)if(n.call(t,o))return i.value=t[o],i.done=!1,i;return i.value=e,i.done=!0,i};return a.next=a}}throw new TypeError(Object(l["a"])(t)+" is not iterable")}return g.prototype=b,o(j,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=d(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,d(e,c,"GeneratorFunction")),e.prototype=Object.create(j),e},t.awrap=function(e){return{__await:e}},w(x.prototype),d(x.prototype,r,(function(){return this})),t.AsyncIterator=x,t.async=function(e,i,n,o,l){void 0===l&&(l=Promise);var a=new x(f(e,i,n,o),l);return t.isGeneratorFunction(i)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},w(j),d(j,c,"Generator"),d(j,s,(function(){return this})),d(j,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),i=[];for(var n in t)i.push(n);return i.reverse(),function e(){for(;i.length;){var n=i.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=N,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var i in this)"t"===i.charAt(0)&&n.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var i=this;function o(n,o){return s.type="throw",s.arg=t,i.next=n,o&&(i.method="next",i.arg=e),!!o}for(var l=this.tryEntries.length-1;l>=0;--l){var a=this.tryEntries[l],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var r=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(r&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(r){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var l=o;break}}l&&("break"===e||"continue"===e)&&l.tryLoc<=t&&t<=l.finallyLoc&&(l=null);var a=l?l.completion:{};return a.type=e,a.arg=t,l?(this.method="next",this.next=l.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),O(i),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var n=i.completion;if("throw"===n.type){var o=n.arg;O(i)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,i,n){return this.delegate={iterator:N(t),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=e),y}},t}var q={name:"SettingsFields",metaInfo:function(){return{title:"".concat(this.$t("settings")," | ").concat(this.$t("editing",{collection:this.$helpers.formatTitle(this.collection)}))}},components:{NotFound:g["default"],VFieldSetup:C,VFieldDuplicate:P},props:{collection:{type:String,required:!0}},data:function(){return{toManage:[],duplicateInterfaceBlacklist:["primary-key","many-to-many","one-to-many","many-to-one","sort"],fieldSaving:!1,saving:!1,dragging:!1,fields:null,directusFields:null,notFound:!1,error:!1,confirmRemove:!1,confirmRemoveLoading:!1,confirmNavigation:!1,leavingTo:"",edits:{},fieldBeingEdited:null,fieldToBeRemoved:null,confirmFieldRemove:!1,fieldBeingDuplicated:null,duplicatingField:!1,editingField:!1}},computed:Object(d["a"])(Object(d["a"])({},Object(E["e"])(["currentProjectKey"])),{},{breadcrumb:function(){return[{name:this.$t("settings"),path:"/".concat(this.currentProjectKey,"/settings")},{name:this.$t("collections_and_fields"),path:"/".concat(this.currentProjectKey,"/settings/collections")},{name:this.$helpers.formatCollection(this.collection),path:"/".concat(this.currentProjectKey,"/settings/collections/").concat(this.collection)}]},collectionInfo:function(){return this.$store.state.collections[this.collection]},fieldsWithSort:function(){return this.fields.map((function(e,t){return Object(d["a"])(Object(d["a"])({},e),{},{sort:t+1})}))},values:function(){return Object(d["a"])(Object(d["a"])({},this.collectionInfo),this.edits)}}),methods:{manageField:function(e){var t=this;this.toManage.push(e.field);var i=this.$store.state.serverInfo.databaseVendor,n=f["a"][i][e.datatype].fallbackInterface,o={field:e.field,sort:e.sort,interface:n},l={fieldInfo:o,relation:null};this.setFieldSettings(l).then(Object(c["a"])(L().mark((function i(){return L().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,t.$store.dispatch("getCollections");case 2:e.interface=n,t.toManage.splice(t.toManage.indexOf(e.field),1);case 4:case"end":return i.stop()}}),i)}))))},remove:function(){var e=this,t=this.$helpers.shortid.generate();this.$store.dispatch("loadingStart",{id:t}),this.$api.deleteCollection(this.collection).then((function(){e.$store.dispatch("loadingFinished",t),e.$store.dispatch("removeCollection",e.collection),e.$notify({title:e.$t("collection_removed"),color:"green",iconMain:"check"}),e.$router.push("/".concat(e.currentProjectKey,"/settings/collections"))})).catch((function(i){e.$store.dispatch("loadingFinished",t),e.$events.emit("error",{notify:e.$t("something_went_wrong_body"),error:i})}))},save:function(){var e=this;this.saving=!0;var t=this.$helpers.shortid.generate();this.$store.dispatch("loadingStart",{id:t}),this.$api.updateCollection(this.collection,this.edits).then((function(){e.$notify({title:e.$t("collection_updated"),color:"green",iconMain:"check"}),e.$store.dispatch("loadingFinished",t),e.saving=!1,e.$store.dispatch("updateCollection",{collection:e.collection,edits:e.edits}),e.$router.push("/".concat(e.currentProjectKey,"/settings/collections"))})).catch((function(i){e.saving=!1,e.$store.dispatch("loadingFinished",t),e.$events.emit("error",{notify:e.$t("something_went_wrong_body"),error:i})}))},stageValue:function(e){var t=e.field,i=e.value;i!==this.collectionInfo[t]?this.$set(this.edits,t,i):this.$delete(this.edits,t)},canDuplicate:function(e){return!!e&&!1===this.duplicateInterfaceBlacklist.includes(e)},duplicateFieldSettings:function(e){var t=this,i=e.fieldInfo,n=e.collection,o=[],l=this.$helpers.shortid.generate();return this.$store.dispatch("loadingStart",{id:l}),i.collection=n,o.push(this.$api.createField(n,i)),Promise.all(o).then((function(e){var t=Object(r["a"])(e,1),i=t[0];return{savedFieldInfo:i.data}})).then((function(e){var o=e.savedFieldInfo;t.$store.dispatch("loadingFinished",l),t.collection===n&&(t.fields=[].concat(Object(s["a"])(t.fields),[o])),t.$store.dispatch("addField",{collection:n,field:o}),t.$notify({title:t.$t("field_created",{field:t.$helpers.formatField(i.field,i.collection)}),color:"green",iconMain:"check"})})).then((function(){t.duplicatingField=!1,t.fieldBeingDuplicated=null})).catch((function(e){t.$store.dispatch("loadingFinished",l),t.$events.emit("error",{notify:t.$t("something_went_wrong_body"),error:e})}))},setFieldSettings:function(e){var t=this;return Object(c["a"])(L().mark((function i(){var n,o,l,r,d,f,u,h,p,v,m,y;return L().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n=e.fieldInfo,o=e.relation,t.fieldSaving=!0,l=t.$store.state.collections[t.collection].fields.hasOwnProperty(n.field),r=t.$helpers.shortid.generate(),t.$store.dispatch("loadingStart",{id:r}),i.prev=5,!l){i.next=15;break}return i.next=9,t.$api.updateField(t.collection,n.field,n);case 9:d=i.sent,f=d.data,t.fields=t.fields.map((function(e){return e.id===f.id?f:e})),t.$notify({title:t.$t("field_updated"),color:"green",iconMain:"check"}),i.next=21;break;case 15:return i.next=17,t.$api.createField(t.collection,n);case 17:u=i.sent,h=u.data,t.fields=[].concat(Object(s["a"])(t.fields),[h]),t.$notify({title:t.$t("field_created"),color:"green",iconMain:"check"});case 21:if(t.$store.dispatch("getCollections"),o)if(p=function(){var e=Object(c["a"])(L().mark((function e(i){var n,o,l,a,s;return L().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=i&&null!=i.id,!n){e.next=9;break}return e.next=4,t.$api.updateRelation(i.id,i);case 4:o=e.sent,l=o.data,t.$store.dispatch("updateRelation",l),e.next=14;break;case 9:return e.next=11,t.$api.createRelation(i);case 11:a=e.sent,s=a.data,t.$store.dispatch("addRelation",s);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Array.isArray(o)){v=Object(a["a"])(o);try{for(v.s();!(m=v.n()).done;)y=m.value,p(y)}catch(_){v.e(_)}finally{v.f()}}else p(o);t.editingField=!1,t.fieldBeingEdited=null,t.fieldSaving=!1,t.$store.dispatch("loadingFinished",r),i.next=34;break;case 29:i.prev=29,i.t0=i["catch"](5),t.fieldSaving=!1,t.$store.dispatch("loadingFinished",r),t.$events.emit("error",{notify:t.$t("something_went_wrong_body"),error:i.t0});case 34:case"end":return i.stop()}}),i,null,[[5,29]])})))()},fieldOptions:function(e){return[{text:this.$t("duplicate"),icon:"control_point_duplicate",disabled:this.duplicateInterfaceBlacklist.includes(e.interface)},{text:this.$t("delete"),icon:"delete_outline"}]},fieldOptionsClicked:function(e,t){switch(t){case 0:this.duplicateField(e);break;case 1:this.warnRemoveField(e.field);break;default:}},duplicateField:function(e){this.fieldBeingDuplicated=e,this.duplicatingField=!0},startEditingField:function(e){this.fieldBeingEdited=e,this.editingField=!0},warnRemoveField:function(e){this.fieldToBeRemoved=e,this.confirmFieldRemove=!0},removeField:function(e){var t=this;this.removingField=!0;var i=this.$helpers.shortid.generate();this.$store.dispatch("loadingStart",{id:i}),this.$api.deleteField(this.collection,e).then((function(){t.$store.dispatch("loadingFinished",i),t.fields=t.fields.filter((function(t){var i=t.field;return i!==e})),t.removingField=!1,t.fieldToBeRemoved=null,t.confirmFieldRemove=!1,t.$notify({title:t.$t("field_removed"),color:"green",iconMain:"check"}),t.$store.dispatch("removeField",{collection:t.collection,field:e})})).catch((function(e){t.$store.dispatch("loadingFinished",i),t.$events.emit("error",{notify:t.$t("something_went_wrong_body"),error:e})}))},startSort:function(){this.dragging=!0},saveSort:function(){var e=this;this.dragging=!1;var t=this.fieldsWithSort.map((function(e){return{field:e.field,sort:e.sort}})),i=this.$helpers.shortid.generate();this.$store.dispatch("loadingStart",{id:i}),this.$api.api.patch("/fields/".concat(this.collection),t,{activity_skip:1}).then((function(e){return e.data})).then((function(n){e.$store.dispatch("loadingFinished",i),e.$store.dispatch("updateFields",{collection:e.collection,updates:t}),e.fields=n})).catch((function(t){e.$store.dispatch("loadingFinished",i),e.$events.emit("error",{notify:e.$t("something_went_wrong_body"),error:t})}))}},beforeRouteEnter:function(e,t,i){var n=e.params.collection,o=m.a.generate();return y["a"].dispatch("loadingStart",{id:o}),Promise.all([_["a"].getFields("directus_collections"),_["a"].getFields(n,{sort:"sort"})]).then((function(e){var t=Object(r["a"])(e,2),i=t[0],n=t[1];return{directusFields:i.data,fields:n.data}})).then((function(e){var t=e.directusFields,n=e.fields;y["a"].dispatch("loadingFinished",o),i((function(e){e.$data.directusFields=Object(u["keyBy"])(t.map((function(e){return Object(d["a"])(Object(d["a"])({},e),{},{name:p()(e.field),note:e.note})})),"field"),delete e.$data.directusFields.note.note,e.$data.directusFields.note.options={placeholder:e.$t("note_note")},e.$data.fields=n.map((function(e){return Object(d["a"])(Object(d["a"])({},e),{},{name:p()(e.field)})})).sort((function(e,t){return e.sort==t.sort?0:null===e.sort?1:null===t.sort?-1:e.sort>t.sort?1:-1}))}))})).catch((function(e){y["a"].dispatch("loadingFinished",o),i((function(t){t.$data.error=e}))}))}},B=q,K=(i("f54e"),Object(k["a"])(B,n,o,!1,null,"3de75d1a",null));t["default"]=K.exports},"4abd":function(e,t,i){},"5bb0":function(e,t,i){},b6c2:function(e,t,i){},c531:function(e,t,i){"use strict";i("5bb0")},e7c8:function(e,t,i){"use strict";i("b6c2")},f54e:function(e,t,i){"use strict";i("4abd")}}]);
//# sourceMappingURL=settings_fields.96e833cf.js.map